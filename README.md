In this repository an example of the code is provided. 

Some modifications have been applied to the original code to make it run under the available resources of the codeocean terminals. 

In order to reproduce the results of the paper make the following changes:

- Simulation_3d:
	* main_segment.py:
		> line 14: start =  1000   
		> line 15: end =  9999
	* main_CNN.py:
		> line 21: CNN.define_model(shp=(shpy,shpz,shpx,3),learat=1e-2)
		> line 22: CNN.train_model(1000,7000,delta_t=80,delta_e=200,max_epoch=2e2,\
                batch_size=8,down_y=dy,down_z=dz,down_x=dx)
	* main_evCNN.py: 
		> line 14: end = 9999
	* main_evCNN_error.py: 
		> line 13: end = 9999
	* main_shap.py
		> line 12: end = 9999
	* readshap.py
		> line 12: end = 9999
	* shap_config.py: 
		> line 66: shap_values = explainer.shap_values(zshap,nsamples="auto")[0][0]
		
- Experiment_2d: 
	* main_segment.py: 
		> line 15: end =  5978
	* main_CNN.py:
		> line 22: CNN.train_model(1,5978,delta_t=5978,delta_e=50,max_epoch=1.3e3,\
                batch_size=128,down_y=dy,down_x=dx) 
	* shap_config.py:
		> line 88: shap_values = explainer.shap_values(zshap,nsamples="auto")[0][0]


In addition, the complete database is required. 
- Simulation_3d: from field 1000 to 9999 total of 9000 fields
- Experiment_2d: from field 1_0 to 0_5978 total of 6100 fields


The repository contains the minimum data to run all the simulations. We recommend running them using the run file.

In case of running the files separately, some issues may occur due to the lack of data which is generated by a previous file.



The complete execution of the files in codeocean could not be tested due to the lack of computational time.
For any trouble or doubt, please contact us:

Andres Cremades Botella: andrescb@kth.se
		
